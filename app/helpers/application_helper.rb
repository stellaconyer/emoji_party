module ApplicationHelper
  def random_emoji(length)
    e = ("😄😃😀😊☺😉😍😘😚😗😙😜😝😛😳😁😔😌😒😞😣" +
    "😢😂😭😪😥😰😅😓😩😫😨😱😠😡😤😖😆😋😷😎😴" +
    "😵😲😟😦😧😈👿😮😬😐😕😯😶😇😏😑👲👳👮👷💂" +
    "👶👦👧👨👩👴👵👱👼👸😺😸😻😽😼🙀😿😹😾👹👺" +
    "🙈🙉🙊💀👽💩🔥✨🌟💫💥💢💦💧💤💨👂👀👃👅👄" +
    "👍👎👌👊✊✌👋✋🖖👐👆👇👉👈🙌🙏☝👏💪🚶🏃💃" +
    "👫👪👬👭💏💑👯🙆🙅💁🙋💆💇💅👰🙎🙍🙇🎩👑👒" +
    "👟👞👡👠👢👕👔👚👗🎽👖👘👙💼👜👝👛👓🎀🌂💄" +
    "💛💙💜💚❤💔💗💓💕💖💞💘💌💋💍💎👤👥💬👣💭" +
    "🐶🐺🐱🐭🐹🐰🐸🐯🐨🐻🐷🐽🐮🐗🐵🐒🐴🐑🐘🐼🐧" +
    "🐦🐤🐥🐣🐔🐍🐢🐛🐝🐜🐞🐌🐙🐚🐠🐟🐬🐳🐋🐄🐏" +
    "🐀🐃🐅🐇🐉🐎🐐🐓🐕🐖🐁🐂🐲🐡🐊🐫🐪🐆🐈🐩🐾" +
    "💐🌸🌷🍀🌹🌻🌺🍁🍃🍂🌿🌾🍄🌵🌴🌲🌳🌰🌱🌼🌐" +
    "🌞🌝🌚🌑🌒🌓🌔🌕🌖🌗🌘🌜🌛🌙🌍🌎🌏🌋🌌🌠⭐" +
    "☀⛅☁⚡☔❄⛄🌀🌁🌈🌊" +
    "🎍💝🎎🎒🎓🎏🎆🎇🎐🎑🎃👻🎅🎄🎁🎋🎉🎊🎈🎌🔮" +
    "🎥📷📹📼💿📀💽💾💻📱☎📞📟📠📡📺📻🔊🔉🔈🔇" +
    "🔔🔕📢📣⏳⌛⏰⌚🔓🔒🔏🔐🔑🔎💡🔦🔆🔅🔌🔋🔍" +
    "🛁🛀🚿🚽🔧🔩🔨🚪🚬💣🔫🔪💊💉💰💴💵💷💶💳💸" +
    "📲📧📥📤✉📩📨📯📫📪📬📭📮📦📝📄📃📑📊📈📉" +
    "📜📋📅📆📇📁📂✂📌📎✒✏📏📐📕📗📘📙📓📔📒" +
    "📚📖🔖📛🔬🔭📰🎨🎬🎤🎧🎼🎵🎶🎹🎻🎺🎷🎸👾🎮" +
    "🃏🎴🀄🎲🎯🏈🏀⚽⚾🎾🎱🏉🎳⛳🚵🚴🏁🏇🏆🎿🏂" +
    "🏊🏄🎣☕🍵🍶🍼🍺🍻🍸🍹🍷🍴🍕🍔🍟🍗🍖🍝🍛🍤" +
    "🍱🍣🍥🍙🍘🍚🍜🍲🍢🍡🍳🍞🍩🍮🍦🍨🍧🎂🍰🍪🍫" +
    "🍬🍭🍯🍎🍏🍊🍋🍒🍇🍉🍓🍑🍈🍌🍐🍍🍠🍆🍅🌽🏠🏡🏫🏢🏣🏥🏦🏪🏩🏨💒⛪🏬🏤🌇🌆🏯🏰⛺🏭🗼" +
    "🗾🗻🌄🌅🌃🗽🌉🎠🎡⛲🎢🚢⛵🚤🚣⚓🚀✈💺🚁🚂" +
    "🚊🚉🚞🚆🚄🚅🚈🚇🚝🚋🚃🚎🚌🚍🚙🚘🚗🚕🚖🚛🚚" +
    "🚨🚓🚔🚒🚑🚐🚲🚡🚟🚠🚜💈🚏🎫🚦🚥⚠🚧🔰⛽🏮" +
    "🎰♨🗿🎪🎭📍🚩").split(//)
    s = ""
    (0..length).each do |i|
      s += "#{e.sample}"
    end
    s
  end

  def generate_ogimage_content(post)
    doc = Nokogiri::HTML(post.body)
    img_srcs = doc.css('img').map{ |i| i['src'] }
    img_srcs.count > 0 ? add_host_if_needed(img_srcs[0]) : asset_url(post.author.photo)
  end

  private

  def add_host_if_needed(image_src)
    if image_src[0] == "/"
        "http://www.emojiparty.net#{img_src}"
    else
        image_src
    end
  end
end

